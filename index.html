<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Easy English Adventure</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;}
body{
margin:0;
font-family:'Comic Sans MS',cursive;
background:linear-gradient(#6dd5fa,#c77dff);
min-height:100vh;
color:white;
overflow-x:hidden;
}

/* ===== AUTOPLAY OVERLAY ===== */
#startOverlay{
position:fixed;
top:0;left:0;right:0;bottom:0;
background:rgba(0,0,0,0.85);
display:flex;
align-items:center;
justify-content:center;
font-size:28px;
z-index:10000;
cursor:pointer;
text-align:center;
padding:20px;
}

/* ===== TOP BAR ===== */
.topbar{
position:fixed;
top:10px;
right:10px;
z-index:9999;
display:flex;
gap:10px;
}
.topbar button{
background:#ffdd00;
border:none;
border-radius:12px;
padding:12px 18px;
font-size:14px;
font-weight:bold;
cursor:pointer;
box-shadow:3px 3px #000;
}

/* ===== SCREEN SYSTEM ===== */
.screen{
display:none;
min-height:100vh;
padding:90px 20px 30px;
animation:fade .6s;
}
.active{
display:flex;
flex-direction:column;
align-items:center;
gap:20px;
}

@keyframes fade{
from{opacity:0;}
to{opacity:1;}
}

h1,h2{
text-shadow:3px 3px #000;
text-align:center;
}

/* ===== BUTTON ===== */
button.main{
padding:15px 30px;
border-radius:20px;
border:none;
font-size:18px;
background:#ffcc00;
cursor:pointer;
box-shadow:3px 3px #000;
}

/* ===== RESPONSIVE ===== */
@media(max-width:600px){
h1{font-size:28px;}
button.main{font-size:16px;}
}
</style>
</head>

<body>

<!-- ===== AUTOPLAY FIX ===== -->
<div id="startOverlay">üëâ Klik di mana saja untuk mulai & aktifkan suara üëà</div>

<!-- ===== TOP BAR ===== -->
<div class="topbar">
  <button onclick="goHome()">üè† Home</button>
  <button id="musicBtn">üéµ Music</button>
</div>

<!-- ===== HOME ===== -->
<div id="home" class="screen active">
  <h1>Easy English Adventure</h1>
  <button class="main" onclick="starGame('animals') ">Start Adventure</button>
  <button class="main" onclick="openGallery()">Learning Gallery</button>
</div>

<!-- ===== MAP (akan diisi di Bagian B) ===== -->
<div id="map" class="screen">
  <h2>Adventure Map</h2>
  <div id="mapArea">Loading map...</div>
</div>

<!-- ===== GAME (akan diisi di Bagian C) ===== -->
<div id="game" class="screen">
  <h2 id="question">Question</h2>
  <div id="gameArea">Loading game...</div>
</div>

<!-- ===== GALLERY (akan diisi di Bagian D) ===== -->
<div id="gallery" class="screen">
  <h2>Learning Gallery</h2>
  <div id="galleryArea">Loading gallery...</div>
</div>

<!-- ===== AUDIO ===== -->
<audio id="bgm" loop src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_0d82b1f3f3.mp3"></audio>
<audio id="correctSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_6b9a2e0c3a.mp3"></audio>
<audio id="wrongSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_76b81b0b20.mp3"></audio>

<script>
let audioUnlocked=false;
const bgm=document.getElementById("bgm");

/* ===== AUTOPLAY FIX ===== */
document.getElementById("startOverlay").addEventListener("click",()=>{
audioUnlocked=true;
bgm.play();
document.getElementById("startOverlay").style.display="none";
});

/* ===== MUSIC BUTTON ===== */
document.getElementById("musicBtn").addEventListener("click",()=>{
if(!audioUnlocked) return;
if(bgm.paused) bgm.play();
else bgm.pause();
});

/* ===== SCREEN CONTROL ===== */
function show(id){
document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
}
function goHome(){show("home");}
function openMap(){show("map");}
function openGallery(){show("gallery");}
</script>

</body>
</html>
<!-- ================= BAGIAN B : AVATAR & MAP ================= -->

<style>
/* ===== AVATAR ===== */
#avatarSelect{
display:flex;
gap:20px;
flex-wrap:wrap;
justify-content:center;
}
.avatarCard{
background:white;
color:black;
padding:15px;
border-radius:15px;
cursor:pointer;
width:120px;
box-shadow:3px 3px #000;
transition:.3s;
}
.avatarCard:hover{transform:scale(1.1);}
.avatarImg{
font-size:50px;
}

/* ===== MAP ===== */
#mapArea{
display:flex;
flex-direction:column;
align-items:center;
gap:25px;
margin-top:20px;
}

.mapNode{
background:white;
color:black;
padding:15px 25px;
border-radius:30px;
font-weight:bold;
cursor:pointer;
box-shadow:3px 3px #000;
position:relative;
}
.mapNode.locked{
background:#aaa;
color:#555;
cursor:not-allowed;
}
.mapNode.done{
background:#7CFF7C;
}
.mapLine{
width:4px;
height:40px;
background:white;
}
</style>

<script>
/* ===== AVATAR DATA ===== */
let playerAvatar=null;
const avatars=[
 {name:"Panda",icon:"üêº"},
 {name:"Puppy",icon:"üê∂"},
 {name:"Kitty",icon:"üê±"},
 {name:"Bunny",icon:"üê∞"}
];

/* ===== WORLD DATA ===== */
const worlds=[
 {id:"animals",name:"üå≥ Animals Forest"},
 {id:"food",name:"üçé Food Town"},
 {id:"colors",name:"üé® Color Hills"},
 {id:"numbers",name:"üî¢ Number Valley"},
 {id:"transport",name:"üöó Transport City"}
];
let unlockedWorld=0;

/* ===== LOAD MAP ===== */
function loadMap(){
const map=document.getElementById("mapArea");
map.innerHTML="";

if(!playerAvatar){
map.innerHTML="<h3>Choose Your Animal Hero</h3><div id='avatarSelect'></div>";
let avDiv=document.getElementById("avatarSelect");
avatars.forEach(a=>{
avDiv.innerHTML+=`
<div class="avatarCard" onclick="selectAvatar('${a.name}')">
<div class="avatarImg">${a.icon}</div>
${a.name}
</div>`;
});
return;
}

worlds.forEach((w,i)=>{
let cls="mapNode";
if(i<unlockedWorld) cls+=" done";
if(i>unlockedWorld) cls+=" locked";

map.innerHTML+=`
<div class="${cls}" onclick="openWorldFromMap(${i})">${w.name}</div>
${i<worlds.length-1?'<div class="mapLine"></div>':""}`;
});
}

/* ===== SELECT AVATAR ===== */
function selectAvatar(name){
playerAvatar=name;
loadMap();
}

/* ===== OPEN WORLD ===== */
function openWorldFromMap(i){
if(i!=unlockedWorld) return;
startGame(worlds[i].id);
}

/* ===== EXTEND openMap() ===== */
const _openMap=openMap;
openMap=function(){
show("map");
loadMap();
}
</script>
<script>
const quizData = {
    animals: ["Cat", "Dog", "Bird", "Cow", "Fish", "Horse", "Lion", "Tiger", "Elephant", "Duck", "Goat", "Sheep", "Monkey", "Frog", "Rabbit"],
    food: ["Apple", "Rice", "Milk", "Bread", "Cake", "Egg", "Fish", "Soup", "Pizza", "Banana", "Burger", "Cheese", "Orange", "Chicken", "Water"],
    colors: ["Red", "Blue", "Green", "Yellow", "Black", "White", "Pink", "Purple", "Orange", "Brown", "Gray", "Cyan", "Gold", "Silver", "Violet"],
    numbers: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15"],
    transport: ["Car", "Bus", "Bike", "Train", "Plane", "Ship", "Truck", "Taxi", "Boat", "Motorcycle", "Helicopter", "Subway", "Scooter", "Tram", "Van"]
};

let currentQ = 0;
let score = 0;
let currentWorld = "";
let quizTimer = null; 

function startGame(world) {
    currentWorld = world;
    currentQ = 0;
    score = 0;
    show("game");
    loadQuestion();
}

function loadQuestion() {
    // 1. Bersihkan timer yang sedang berjalan sebelum mulai baru
    if (quizTimer) clearInterval(quizTimer);

    const list = quizData[currentWorld];
    
    // Cek jika kuis selesai
    if (currentQ >= 15) {
        endWorld();
        return;
    }

    const correct = list[currentQ];
    document.getElementById("question").innerText = "Find: " + correct;

    // Acak pilihan jawaban
    let options = [correct];
    while (options.length < 3) {
        let r = list[Math.floor(Math.random() * 15)];
        if (!options.includes(r)) options.push(r);
    }
    options.sort(() => Math.random() - 0.5);

    // Update Tampilan
    document.getElementById("gameArea").innerHTML = `
        <div id="timer">5</div>
        <div id="progressBar"><div id="progressFill"></div></div>
        <div class="optionBox">
            ${options.map(o => <div class="option" onclick="selectAnswer(this,'${o}','${correct}')">${o}</div>).join("")}
        </div>`;

    // Jalankan Timer
    let time = 5;
    document.getElementById("progressFill").style.width = (currentQ / 15 * 100) + "%";

    quizTimer = setInterval(() => {
        time--;
        document.getElementById("timer").innerText = time;
        if (time <= 0) {
            clearInterval(quizTimer);
            currentQ++;
            loadQuestion();
        }
    }, 1000);
}

function selectAnswer(el, picked, correct) {
    // Hentikan timer segera setelah jawaban diklik
    clearInterval(quizTimer);

    // Matikan klik agar tidak bisa tekan dua kali
    document.querySelectorAll(".option").forEach(o => o.style.pointerEvents = "none");

    if (picked == correct) {
        el.classList.add("correct");
        score++;
        document.getElementById("correctSound").play();
    } else {
        el.classList.add("wrong");
        document.getElementById("wrongSound").play();
    }

    // Tunggu sebentar lalu lanjut ke soal berikutnya
    setTimeout(() => {
        currentQ++;
        loadQuestion();
    }, 800);
}

function endWorld() {
    if (quizTimer) clearInterval(quizTimer);
    unlockedWorld++;
    show("map");
    loadMap();
    alert("World complete! Your Score: " + score);
}
</script>
<script>
const quizData = {
    animals: ["Cat", "Dog", "Bird", "Cow", "Fish", "Horse", "Lion", "Tiger", "Elephant", "Duck", "Goat", "Sheep", "Monkey", "Frog", "Rabbit"],
    food: ["Apple", "Rice", "Milk", "Bread", "Cake", "Egg", "Fish", "Soup", "Pizza", "Banana", "Burger", "Cheese", "Orange", "Chicken", "Water"],
    colors: ["Red", "Blue", "Green", "Yellow", "Black", "White", "Pink", "Purple", "Orange", "Brown", "Gray", "Cyan", "Gold", "Silver", "Violet"],
    numbers: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15"],
    transport: ["Car", "Bus", "Bike", "Train", "Plane", "Ship", "Truck", "Taxi", "Boat", "Motorcycle", "Helicopter", "Subway", "Scooter", "Tram", "Van"]
};

let currentQ = 0;
let score = 0;
let currentWorld = "";
let quizTimer = null; 

function startGame(world) {
    currentWorld = world;
    currentQ = 0;
    score = 0;
    show("game");
    loadQuestion();
}

function loadQuestion() {
    // 1. Bersihkan timer yang sedang berjalan sebelum mulai baru
    if (quizTimer) clearInterval(quizTimer);

    const list = quizData[currentWorld];
    
    // Cek jika kuis selesai
    if (currentQ >= 15) {
        endWorld();
        return;
    }

    const correct = list[currentQ];
    document.getElementById("question").innerText = "Find: " + correct;

    // Acak pilihan jawaban
    let options = [correct];
    while (options.length < 3) {
        let r = list[Math.floor(Math.random() * 15)];
        if (!options.includes(r)) options.push(r);
    }
    options.sort(() => Math.random() - 0.5);

    // Update Tampilan
   document.getElementById("gameArea").innerHTML = `
    <div id="timer">5</div>
    <div id="progressBar"><div id="progressFill"></div></div>
    <div class="optionBox">
        ${options.map(o => <div class="option" onclick="selectAnswer(this,'${o}','${correct}')">${o}</div>).join("")}
    </div>`;

    // Jalankan Timer
    let time = 5;
    document.getElementById("progressFill").style.width = (currentQ / 15 * 100) + "%";

    quizTimer = setInterval(() => {
        time--;
        document.getElementById("timer").innerText = time;
        if (time <= 0) {
            clearInterval(quizTimer);
            currentQ++;
            loadQuestion();
        }
    }, 1000);
}

function selectAnswer(el, picked, correct) {
    // Hentikan timer segera setelah jawaban diklik
    clearInterval(quizTimer);

    // Matikan klik agar tidak bisa tekan dua kali
    document.querySelectorAll(".option").forEach(o => o.style.pointerEvents = "none");

    if (picked == correct) {
        el.classList.add("correct");
        score++;
        document.getElementById("correctSound").play();
    } else {
        el.classList.add("wrong");
        document.getElementById("wrongSound").play();
    }

    // Tunggu sebentar lalu lanjut ke soal berikutnya
    setTimeout(() => {
        currentQ++;
        loadQuestion();
    }, 800);
}

function endWorld() {
    if (quizTimer) clearInterval(quizTimer);
    unlockedWorld++;
    show("map");
    loadMap();
    alert("World complete! Your Score: " + score);
}
</script>
<!-- ================= BAGIAN D : LEARNING GALLERY ================= -->
<style>
#galleryArea{
display:flex;
flex-direction:column;
align-items:center;
gap:20px;
}
#galleryImg{
font-size:120px;
}
#galleryText{
font-size:28px;
font-weight:bold;
text-shadow:2px 2px #000;
}
.galleryControls{
display:flex;
gap:15px;
}
.galleryControls button{
padding:10px 20px;
border-radius:15px;
border:none;
background:#ffdd00;
font-size:18px;
cursor:pointer;
box-shadow:3px 3px #000;
}
</style>

<script>
const galleryData=[
 {name:"Cat",icon:"üê±"},
 {name:"Dog",icon:"üê∂"},
 {name:"Apple",icon:"üçé"},
 {name:"Car",icon:"üöó"},
 {name:"Bus",icon:"üöå"},
 {name:"Banana",icon:"üçå"},
 {name:"Lion",icon:"ü¶Å"},
 {name:"Fish",icon:"üêü"}
];
let gIndex=0;

function loadGallery(){
show("gallery");
renderGallery();
}

function renderGallery(){
const item=galleryData[gIndex];
document.getElementById("galleryArea").innerHTML=`
<div id="galleryImg">${item.icon}</div>
<div id="galleryText">${item.name}</div>
<div class="galleryControls">
<button onclick="prevItem()">‚èÆ</button>
<button onclick="speakItem()">üîä</button>
<button onclick="nextItem()">‚è≠</button>
</div>`;
}

function nextItem(){
gIndex=(gIndex+1)%galleryData.length;
renderGallery();
}
function prevItem(){
gIndex--;
if(gIndex<0) gIndex=galleryData.length-1;
renderGallery();
}
function speakItem(){
let u=new SpeechSynthesisUtterance(galleryData[gIndex].name);
speechSynthesis.speak(u);
}

/* Override openGallery from Part A */
const _openGallery=openGallery;
openGallery=function(){
loadGallery();
}
</script>
